<app-section-header [text]="'Admin: ' + config.name"></app-section-header>
<div class="table-wrapper">
  <mat-card>
    <caption class="mat-subheading-title" [style.fontWeight]="500">
      Filter
    </caption>
    <app-dynamic-filter-form
      [columns]="config.columns"
      (submitItem)="onSubmitFilter($event)"
      (resetFilter)="onResetFilter()"
    >
    </app-dynamic-filter-form>
  </mat-card>

  <mat-card class="create-form">
    <div class="create-form-wrapper">
      <!-- <caption class="mat-subheading-title" [style.fontWeight]="500">
        Create
      </caption> -->
      <app-dynamic-form
        [columns]="config.columns"
        [inputData]="null"
        [mode]="'create'"
        [labels]="{ submit: 'Create', reset: 'Clear' }"
        (submitItem)="onCreate($event)"
        (unpickItem)="onUnpickTableItem()"
      >
      </app-dynamic-form>
    </div>
  </mat-card>

  <p class="table__status">
    Status:
    {{ status }}
  </p>

  <mat-card class="table-card" [class.mat-elevation-z1]="'true'">
    <table class="table">
      <!-- ## Column Headers row -->
      <tr class="table__row table__row--headers">
        <div class="row__content row__content--headers mat-small">
          <td
            class="table__column table__column--header table__data"
            *ngFor="let col of config.columns"
          >
            {{ col.label }}
          </td>
          <td
            class="table__column table__column--header table__column--actions table__data"
          >
            Actions
          </td>
        </div>
      </tr>

      <!-- ## Item Data rows ## -->
      <tr *ngFor="let item of items" class="table__row">
        <!-- ## Row content if currentlyEdited is not set ## -->
        <!-- Render regular table data (displaying) -->
        <div *ngIf="!currentlyEdited" class="row__content">
          <td
            *ngFor="let col of config.columns"
            class="table__column table__data"
            [class.table__data--id]="col.name === 'id'"
          >
            {{ item[col.name] }}
          </td>
          <td class="table__column table__column--actions table__data">
            <button
              [class.mat-elevation-z3]="'true'"
              mat-mini-fab
              color="primary"
              type="button"
              (click)="onPickTableItem(item)"
            >
              <mat-icon fontSet="material-icons-outlined" matSuffix
                >edit</mat-icon
              >
            </button>
            <button
              [class.mat-elevation-z3]="'true'"
              mat-mini-fab
              color="warn"
              type="button"
              (click)="onDelete(item)"
            >
              <mat-icon fontSet="material-icons-outlined" matSuffix
                >delete</mat-icon
              >
            </button>
          </td>
        </div>

        <!-- ## Row content if currentlyEdited is set ## -->
        <div *ngIf="currentlyEdited" class="row__content">
          <!-- Render regular table data if item doesn't 
              match currentlyEdited (displaying) -->
          <div
            *ngIf="item.id !== (currentlyEdited.id || null)"
            class="row__content"
          >
            <td
              class="table__column table__data"
              *ngFor="let col of config.columns"
              [class.table__data--id]="col.name === 'id'"
            >
              {{ item[col.name] }}
            </td>
            <td class="table__column table__data table__column--actions">
              <button
                [class.mat-elevation-z3]="'true'"
                mat-mini-fab
                color="primary"
                type="button"
                (click)="onPickTableItem(item)"
              >
                <mat-icon fontSet="material-icons-outlined" matSuffix
                  >edit</mat-icon
                >
              </button>
              <button
                [class.mat-elevation-z3]="'true'"
                mat-mini-fab
                color="warn"
                type="button"
                (click)="onDelete(item)"
              >
                <mat-icon fontSet="material-icons-outlined" matSuffix
                  >delete</mat-icon
                >
              </button>
            </td>
          </div>

          <!-- ## Insert form into row if current item matches 
              currentlyEdited (editing) ## -->
          <div *ngIf="item.id === (currentlyEdited.id || null)" class="form">
            <app-dynamic-form
              [columns]="config.columns"
              [inputData]="currentlyEdited"
              [mode]="'edit'"
              [labels]="{ submit: 'Save', reset: 'Cancel' }"
              (submitItem)="onUpdate($event)"
              (unpickItem)="onUnpickTableItem()"
            >
            </app-dynamic-form>
          </div>
        </div>
      </tr>
    </table>
  </mat-card>
</div>
