<app-section-header [text]="'Admin: ' + config.name"></app-section-header>
<div class="table__wrapper">
  <div
    [ngSwitch]="config.modals"
    class="create__wrapper"
    [class.create__wrapper--modal]="config.modals"
  >
    <button
      *ngSwitchCase="true"
      mat-raised-button
      class="btn"
      (click)="openDialog()"
    >
      CREATE
    </button>

    <mat-card *ngSwitchCase="false" class="create-form__card">
      {{ "register-form" | language }}
      <div class="create-form__wrapper">
        <app-dynamic-form
          [mode]="'create'"
          [columns]="config.columns"
          [labels]="{ submit: 'Create', reset: 'Clear' }"
          [inputData]="null"
          (submitItem)="onCreate($event)"
          (unpickItem)="onUnpickTableItem()"
        >
        </app-dynamic-form>
      </div>
    </mat-card>
  </div>

  <mat-card class="table__card" [class.mat-elevation-z1]="'true'">
    <table class="table">
      <!-- ## Column Headers row -->
      <tr class="table__row table__row--headers">
        <div class="row__content row__content--headers mat-small">
          <td
            class="table__column table__column--header"
            *ngFor="let col of config.columns"
          >
            {{ col.label }}
          </td>
          <td
            class="table__column table__column--header table__column--actions"
          >
            Actions
          </td>
        </div>
      </tr>

      <tr class="form form--filter">
        <app-dynamic-filter-form
          [columns]="config.columns"
          (submitItem)="onSubmitFilter($event)"
          (resetFilter)="onResetFilter()"
        >
        </app-dynamic-filter-form>
      </tr>

      <!-- ## Item Data rows ## -->
      <tr *ngFor="let item of items" class="table__row">
        <!-- ## Row content if currentlyEdited is not set ## -->
        <!-- Render regular table data (displaying) -->
        <div *ngIf="!currentlyEdited" class="row__content">
          <td
            *ngFor="let col of config.columns"
            class="table__column"
            [class.table__column--id]="col.name === 'id'"
          >
            {{ item[col.name] }}
          </td>
          <td class="table__column table__column--actions">
            <button
              [class.mat-elevation-z2]="'true'"
              mat-mini-fab
              color="primary"
              type="button"
              (click)="onPickTableItem(item)"
            >
              <mat-icon fontSet="material-icons-outlined" matSuffix
                >edit</mat-icon
              >
            </button>
            <button
              [class.mat-elevation-z2]="'true'"
              mat-mini-fab
              color="warn"
              type="button"
              (click)="onDelete(item)"
            >
              <mat-icon fontSet="material-icons-outlined" matSuffix
                >delete</mat-icon
              >
            </button>
          </td>
        </div>

        <!-- ## Row content if currentlyEdited is set ## -->
        <div *ngIf="currentlyEdited" class="row__content">
          <!-- Render regular table data if item doesn't 
              match currentlyEdited (displaying) -->
          <div
            *ngIf="item.id !== (currentlyEdited.id || null)"
            class="row__content"
          >
            <td
              class="table__column"
              *ngFor="let col of config.columns"
              [class.table__column--id]="col.name === 'id'"
            >
              {{ item[col.name] }}
            </td>
            <td class="table__column table__column--actions">
              <button
                [class.mat-elevation-z2]="'true'"
                mat-mini-fab
                color="primary"
                type="button"
                (click)="onPickTableItem(item)"
              >
                <mat-icon fontSet="material-icons-outlined" matSuffix
                  >edit</mat-icon
                >
              </button>
              <button
                [class.mat-elevation-z2]="'true'"
                mat-mini-fab
                color="warn"
                type="button"
                (click)="onDelete(item)"
              >
                <mat-icon fontSet="material-icons-outlined" matSuffix
                  >delete</mat-icon
                >
              </button>
            </td>
          </div>

          <!-- ## Insert form into row if current item matches 
              currentlyEdited (editing) ## -->
          <div
            *ngIf="item.id === (currentlyEdited.id || null)"
            class="edit-form"
          >
            <app-dynamic-form
              [columns]="config.columns"
              [inputData]="currentlyEdited"
              [mode]="'edit'"
              [labels]="{ submit: 'Save', reset: 'Cancel' }"
              (submitItem)="onUpdate($event)"
              (unpickItem)="onUnpickTableItem()"
            >
            </app-dynamic-form>
          </div>
        </div>
      </tr>
    </table>
  </mat-card>
</div>
