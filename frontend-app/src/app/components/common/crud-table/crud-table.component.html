<app-section-header [text]="'Admin: ' + config.name"></app-section-header>
<app-dynamic-form [questions]="questions$ | async"></app-dynamic-form>
<div class="table-wrapper">
  <!-- <button
    mat-fab
    color="accent"
    class="btn-add-row"
    (click)="newRow()"
  >
    <mat-icon fontSet="material-icons-outlined" matSuffix>add_box</mat-icon>
  </button> -->

  <mat-table
    *ngIf="dataSource"
    [dataSource]="dataSource"
    class="table"
    matSort
    [class.mat-elevation-z3]="'true'"
  >
    <ng-container *ngFor="let col of displayedColumns" [matColumnDef]="col">
      <mat-header-cell *matHeaderCellDef>
        {{ col | titlecase }}
      </mat-header-cell>

      <mat-cell *matCellDef="let object" class="cell" [ngSwitch]="col">
        <span *ngSwitchDefault class="cell__content"> {{ object[col] }}</span>

        <span *ngSwitchCase="'roles'" class="cell__content">
          <div *ngFor="let item of object['roles'] | keyvalue">
            <span *ngIf="item.value" class="cell__content cell__content--id">
              {{ item.key }}</span
            >
          </div>
        </span>

        <span *ngSwitchCase="'id'" class="cell__content cell__content--id">
          {{ object[col] }}</span
        >

        <span
          *ngSwitchCase="'heldByClient'"
          class="cell__content cell__content--id"
        >
          {{ object[col] }}</span
        >
        <span *ngSwitchCase="'actions'" class="cell__content">
          <button
            mat-mini-fab
            color="primary"
            class="btn-add-row"
            type="button"
            (click)="openDialog('edit', object)"
          >
            <mat-icon fontSet="material-icons-outlined" matSuffix
              >edit</mat-icon
            >
          </button>

          <button
            mat-mini-fab
            color="warn"
            type="button"
            (click)="onDelete(object)"
            class="cell__button"
          >
            <mat-icon fontSet="material-icons-outlined" matSuffix
              >delete</mat-icon
            >
          </button></span
        >
      </mat-cell>
    </ng-container>

    <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
    <mat-row
      *matRowDef="let row; columns: displayedColumns"
      class="table__row"
    ></mat-row>
  </mat-table>
</div>
